<!DOCTYPE html>
<html>
  <head>
    <title>A Gentle Guide to the Grammar of Graphics with ggplot2</title>
    <meta charset="utf-8">
    <meta name="author" content="Garrick Aden-Buie @grrrck" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/metropolis.css" rel="stylesheet" />
    <link href="libs/remark-css/metropolis-fonts.css" rel="stylesheet" />
    <link rel="stylesheet" href="gentle-ggplot2.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# A Gentle Guide to the Grammar of Graphics<br>with <code>ggplot2</code>
### Garrick Aden-Buie<br><span class="citation">@grrrck</span>
### Follow along: <strong>bit.ly/gentle-ggplot2</strong>

---


class: fullscreen, inverse, top, center, text-white
background-image: url("images/letter-g.jpg")

.font150[**Brought to you by the letter...**]



---
layout: true
# Why *ggplot2*?
---

.left-column[
![](images/hadley.jpg)
__Hadley Wickham__
]

.right-column[.font150[
The transferrable skills from ggplot2 are not the idiosyncracies of plotting syntax, but a powerful way of thinking about visualisation, as a way of **mapping between variables and the visual properties of geometric objects** that you can perceive.
]
.footnote[&lt;http://disq.us/p/sv640d&gt;]
]


---

## My personal reasons

- .hl[Functional] data visualization

    1. Wrange data
    2. Map data to visual elements
    3. Tweak scales, guides, axis, labels, theme

- Easy to .hl[reason] about how data drives visualization

- Easy to .hl[iterate]

- Easy to be .hl[consistent]

---
layout: false

# What are we getting into?

&lt;br&gt;
`ggplot2` is a huge package: philosophy + functions
&lt;br&gt;...but it's very well organized

--

&lt;br&gt;&lt;br&gt;
*Lots* of examples of not-so-great plots in these slides
&lt;br&gt;...but that's okay

--

&lt;br&gt;&lt;br&gt;
Going to throw a lot at you
&lt;br&gt;...but you'll know *where* and *what* to look for

--

.img-right[![](images/poppins-bag.gif)]

--

.img-right[![](images/poppins-bag-kids.gif)]

---
layout: true
# G is for getting started

---


**Easy**: install the [tidyverse](http://tidyverse.org)

```r
install.packages('tidyverse')
```

**Medium**: install just `ggplot2`

```r
install.pacakages('ggplot2')
```

**Expert**: install from GitHub

```r
devtools::install_github('tidyverse/ggplot2')
```

---

## Load the tidyverse


```r
library(tidyverse)
```

---
layout: false
class: inverse center middle text-white

.font200[gg is for&lt;br&gt;Grammar of Graphics]

---
layout: true
# Guess the data behind this plot?

.pull-left[
### MPG Ratings of Cars

- Manufacturer
- Model
- City MPG
- Highway MPG
]

---

.pull-right[
&lt;img src="index_files/figure-html/guess-data-from-plot-1.png" width="100%" /&gt;
]

---

.pull-right[
&lt;img src="index_files/figure-html/unnamed-chunk-1-1.png" width="100%" /&gt;
]

---

.pull-right[
&lt;img src="index_files/figure-html/unnamed-chunk-2-1.png" width="100%" /&gt;
]

---

.pull-right[
&lt;img src="index_files/figure-html/unnamed-chunk-3-1.png" width="100%" /&gt;
]

---

.pull-right[
&lt;img src="index_files/figure-html/unnamed-chunk-4-1.png" width="100%" /&gt;
]

---

.pull-right[
&lt;img src="index_files/figure-html/unnamed-chunk-5-1.png" width="100%" /&gt;
]

---

.pull-right[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; model &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; manufacturer &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; class &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; cty &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; hwy &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; a4 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; audi &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; compact &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 31 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; a4 quattro &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; audi &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; compact &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 28 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; expedition 2wd &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ford &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; suv &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; explorer 4wd &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; ford &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; suv &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 13 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 19 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; 4runner 4wd &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; toyota &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; suv &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 17 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; camry solara &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; toyota &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; compact &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 22 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 31 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; corolla &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; toyota &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; compact &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 28 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 37 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; land cruiser wagon 4wd &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; toyota &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; suv &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 13 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

---
layout: false
## Other packages you'll need for this adventure


```r
library(lubridate)       # tidyverse
library(reshape2)        # install.packages("reshape2")
library(babynames)       # install.packages("babynames")
```

---
layout: true
# gg is for Grammar of Graphics

.left-column[
### Data

```r
g &lt;- ggplot()
```
]

---

.right-column[
#### Tidy Data

1. Each variable forms a .hl[column]

2. Each observation forms a .hl[row]

3. Each observational unit forms a table

&lt;br&gt;&lt;br&gt;The following example draws from

```r
data(population, package = "tidyr")
```

]

---

.right-column[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; 1995 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; 2000 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; 2005 &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; 2010 &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Canada &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 29.2949 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30.69742 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 32.25309 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 34.12624 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; China &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1237.5314 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1280.42858 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1318.17683 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1359.82146 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; USA &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 268.0397 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 284.59440 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 298.16580 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 312.24712 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


&lt;br&gt;
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Canada &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; China &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; USA &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1995 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 29.29490 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1237.531 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 268.0397 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30.69742 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1280.429 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 284.5944 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2005 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 32.25309 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1318.177 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 298.1658 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2010 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 34.12624 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1359.821 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 312.2471 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

---

.right-column[

```r
tidy1 &lt;- gather(messy1, 'year', 'population', -country)
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; population &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Canada &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1995 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 29.295 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; China &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1995 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1237.531 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; USA &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 1995 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 268.040 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Canada &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30.697 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; China &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1280.429 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; USA &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2000 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 284.594 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Canada &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2005 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 32.253 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; China &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2005 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1318.177 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; USA &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2005 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 298.166 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Canada &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2010 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 34.126 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; China &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2010 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1359.821 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; USA &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; 2010 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 312.247 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

---

.right-column[

```r
tidy2 &lt;- gather(messy2, 'country', 'population', -year)
```

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; country &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; population &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1995 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Canada &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 29.295 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Canada &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 30.697 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2005 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Canada &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 32.253 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2010 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Canada &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 34.126 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1995 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; China &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1237.531 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; China &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1280.429 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2005 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; China &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1318.177 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2010 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; China &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1359.821 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1995 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; USA &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 268.040 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2000 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; USA &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 284.594 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2005 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; USA &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 298.166 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2010 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; USA &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 312.247 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

---
layout: true
# gg is for Grammar of Graphics

.left-column[
### Data
### Aesthetics

```r
g + aes()
```

]
---

.right-column[
Map data to visual elements or parameters

- year

- population

- country
]

---

.right-column[
Map data to visual elements or parameters

- year → **x**

- population → **y**

- country → *shape*, *color*, etc.
]

---
layout: true
# gg is for Grammar of Graphics

.left-column[
### Data
### Aesthetics
### Geoms

```r
g + geom_*()
```
]

---

Geometric objects displayed on the plot:

.font80[
| Type | Function |
|:----:|:--------:|
| Point | `geom_point()` |
| Line | `geom_line()` |
| Bar | `geom_bar()`, `geom_col()` |
| Histogram | `geom_histogram()` |
| Regression | `geom_smooth()` |
| Boxplot | `geom_boxplot()` |
| Text | `geom_text()` |
| Vert./Horiz. Line | `geom_{vh}line()` |
| Count | `geom_count()` |
| Density | `geom_density()` |
]

---

.right-column[
Those are just the [top 10 most popular geoms](https://eric.netlify.com/2017/08/10/most-popular-ggplot2-geoms/)&lt;sup&gt;1&lt;/sup&gt;

See &lt;http://ggplot2.tidyverse.org/reference/&gt; for many more options

Or just start typing `geom_` in RStudio

.font70[

```
##  [1] "geom_abline"     "geom_area"       "geom_bar"        "geom_bin2d"     
##  [5] "geom_blank"      "geom_boxplot"    "geom_col"        "geom_contour"   
##  [9] "geom_count"      "geom_crossbar"   "geom_curve"      "geom_density"   
## [13] "geom_density_2d" "geom_density2d"  "geom_dotplot"    "geom_errorbar"  
## [17] "geom_errorbarh"  "geom_freqpoly"   "geom_hex"        "geom_histogram" 
## [21] "geom_hline"      "geom_jitter"     "geom_label"      "geom_line"      
## [25] "geom_linerange" 
##  [ reached getOption("max.print") -- omitted 21 entries ]
```
]]

.footnote[[1] &lt;https://eric.netlify.com/2017/08/10/most-popular-ggplot2-geoms/&gt;]

---
layout: true
# Our first plot!
---

.left-code[

```r
ggplot(tidy1)
```
]

.right-plot[
&lt;img src="index_files/figure-html/first-plot1a-out-1.png" width="100%" /&gt;
]

---

.left-code[

```r
ggplot(tidy1) +
* aes(x = year,
*     y = population)
```
]

.right-plot[
&lt;img src="index_files/figure-html/first-plot1b-out-1.png" width="100%" /&gt;
]

---

.left-code[

```r
ggplot(tidy1) +
  aes(x = year,
      y = population) +
* geom_point()
```
]

.right-plot[
&lt;img src="index_files/figure-html/first-plot1c-out-1.png" width="100%" /&gt;
]

---

.left-code[

```r
ggplot(tidy1) +
  aes(x = year,
      y = population,
*     color = country) +
  geom_point()
```
]

.right-plot[
&lt;img src="index_files/figure-html/first-plot1-out-1.png" width="100%" /&gt;
]

---

.left-code[

```r
ggplot(tidy1) +
  aes(x = year,
      y = population,
      color = country) +
  geom_point() +
* geom_line()
```

.font80[
```r
geom_path: Each group consists
of only one observation. 
Do you need to adjust the 
group aesthetic?
```
]
]

.right-plot[
&lt;img src="index_files/figure-html/first-plot2-fake-out-1.png" width="100%" /&gt;
]
---

.left-code[

```r
ggplot(tidy1) +
  aes(x = year,
      y = population,
      color = country) +
  geom_point() +
  geom_line(
*   aes(group = country))
```
]

.right-plot[
&lt;img src="index_files/figure-html/first-plot2-out-1.png" width="100%" /&gt;
]

---
layout: true
# gg is for Grammar of Graphics

.left-column[
### Data
### Aesthetics
### Geoms

```r
g + geom_*()
```
]
---

.right-column[
```r
geom_*(mapping, data, stat, position)
```

- `data` Geoms can have their own data
    - Has to map onto global coordinates

- `map` Geoms can have their own aesthetics
    - Inherits global aesthetics
    - Have geom-specific aesthetics
        - `geom_point` needs `x` and `y`, optional `shape`, `color`, `size`, etc.
        - `geom_ribbon` requires `x`, `ymin` and `ymax`, optional `fill`
    - `?geom_ribbon`
]

---

.right-column[
```r
geom_*(mapping, data, stat, position)
```

- `stat` Some geoms apply further transformations to the data
    - All respect `stat = 'identity'`
    - Ex: `geom_histogram` uses `stat_bin()` to group observations
    
- `position` Some adjust location of objects
    - `'dodge'`, `'stack'`, `'jitter'`
]

---
layout: true
# Example: Stat and Position
---

.pull-left[
#### Star Wars Characters

.font90[

```r
sw_chars &lt;- starwars %&gt;% 
  mutate(
    n_movies = map_int(films, length), 
    gender = ifelse(
      !gender %in% c('female', 'male'), 
      'other', gender)
  ) %&gt;% 
  select(name, gender, n_movies)
```
]]

.pull-right[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; name &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; gender &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; n_movies &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Luke Skywalker &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; C-3PO &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; other &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; R2-D2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; other &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Darth Vader &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Leia Organa &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Owen Lars &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Beru Whitesun lars &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; R5-D4 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; other &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Biggs Darklighter &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Obi-Wan Kenobi &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Anakin Skywalker &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Wilhuff Tarkin &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Chewbacca &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Han Solo &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Greedo &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Jabba Desilijic Tiure &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; other &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Wedge Antilles &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Jek Tono Porkins &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Yoda &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Palpatine &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Boba Fett &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; IG-88 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; other &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Bossk &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Lando Calrissian &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Lobot &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Ackbar &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Mon Mothma &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Arvel Crynyd &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Wicket Systri Warrick &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Nien Nunb &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Qui-Gon Jinn &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Nute Gunray &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Finis Valorum &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Jar Jar Binks &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Roos Tarpals &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Rugor Nass &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Ric Olié &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Watto &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Sebulba &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Quarsh Panaka &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Shmi Skywalker &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Darth Maul &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Bib Fortuna &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Ayla Secura &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Dud Bolt &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Gasgano &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Ben Quadinaros &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Mace Windu &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Ki-Adi-Mundi &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Kit Fisto &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Eeth Koth &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Adi Gallia &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Saesee Tiin &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Yarael Poof &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Plo Koon &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Mas Amedda &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Gregar Typho &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Cordé &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Cliegg Lars &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Poggle the Lesser &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Luminara Unduli &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Barriss Offee &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Dormé &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Dooku &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Bail Prestor Organa &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Jango Fett &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Zam Wesell &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Dexter Jettster &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Lama Su &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Taun We &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Jocasta Nu &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Ratts Tyerell &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; R4-P17 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Wat Tambor &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; San Hill &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Shaak Ti &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Grievous &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Tarfful &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Raymus Antilles &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Sly Moore &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Tion Medon &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Finn &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Rey &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Poe Dameron &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; BB8 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; other &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Captain Phasma &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; Padmé Amidala &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

---

.left-code[

```r
ggplot(sw_chars) +
  aes(x = n_movies) +
  geom_bar(stat = "count")
```
]

.right-plot[
&lt;img src="index_files/figure-html/stat-example-out-1.png" width="100%" /&gt;
]


---

.left-code[

```r
ggplot(sw_chars) +
  aes(x = n_movies,
*     fill = gender) +
  geom_bar(stat = "count")
```
]

.right-plot[
&lt;img src="index_files/figure-html/stat-example2-out-1.png" width="100%" /&gt;
]


---

.pull-left[.font90[

```r
sw_chars_id &lt;- sw_chars %&gt;% 
  group_by(n_movies, gender) %&gt;% 
  tally
```
]]

.pull-right[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; n_movies &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; gender &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; n &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 34 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; other &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 12 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 9 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; other &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; female &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; male &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; other &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; other &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

---

.left-code[

```r
ggplot(sw_chars_id) +
  aes(x = n_movies,
      y = n,
      fill = gender) +
* geom_bar(stat = 'identity')
```

.font80[Note: `geom_col()` is alias for &lt;br&gt;`geom_bar(stat = 'identity')` ]
]

.right-plot[
&lt;img src="index_files/figure-html/stat-example4-out-1.png" width="100%" /&gt;
]

---

.left-code[

```r
ggplot(sw_chars_id) +
  aes(x = n_movies,
      y = n,
      fill = gender) +
* geom_col(position = "fill")
```
]

.right-plot[
&lt;img src="index_files/figure-html/stat-example5-out-1.png" width="100%" /&gt;
]

---

.left-code[

```r
ggplot(sw_chars_id) +
  aes(x = n_movies,
      y = n,
      fill = gender) +
* geom_col(position = "dodge")
```
]

.right-plot[
&lt;img src="index_files/figure-html/stat-example3-out-1.png" width="100%" /&gt;
]

---
layout: false
exclude: true
# Stat and position are functions too

#### Stat transformations


```
##  [1] "stat_bin"         "stat_bin_2d"      "stat_bin_hex"     "stat_bin2d"      
##  [5] "stat_binhex"      "stat_boxplot"     "stat_contour"     "stat_count"      
##  [9] "stat_density"     "stat_density_2d"  "stat_density2d"   "stat_ecdf"       
## [13] "stat_ellipse"     "stat_function"    "stat_identity"    "stat_qq"         
## [17] "stat_qq_line"     "stat_quantile"    "stat_sf"          "stat_smooth"     
## [21] "stat_spoke"       "stat_sum"         "stat_summary"     "stat_summary_2d" 
## [25] "stat_summary_bin"
##  [ reached getOption("max.print") -- omitted 4 entries ]
```

#### Position transformations


```
## [1] "position_dodge"       "position_dodge2"      "position_fill"       
## [4] "position_identity"    "position_jitter"      "position_jitterdodge"
## [7] "position_nudge"       "position_stack"
```

---
layout: true
# gg is for Grammar of Graphics

.left-column[
### Data
### Aesthetics
### Geoms
### Facet

```r
g+facet_wrap() 

g+facet_grid()
```
]
---



.right-column[

```r
g &lt;- ggplot(sw_chars) +
  aes(x = n_movies,
      fill = gender) +
  geom_bar()
```
]

---

.right-column[

```r
g + facet_wrap(~ gender)
```

&lt;img src="index_files/figure-html/unnamed-chunk-9-1.png" width="75%" /&gt;
]

---

.right-column[

```r
g + facet_grid(gender ~ hair_color)
```

&lt;img src="index_files/figure-html/unnamed-chunk-10-1.png" width="75%" /&gt;
]

---

.right-column[

```r
g + facet_grid(gender ~ hair_color, scales = 'free_y')
```

&lt;img src="index_files/figure-html/unnamed-chunk-11-1.png" width="75%" /&gt;
]

---
layout: true
# gg is for Grammar of Graphics

.left-column[
### Data
### Aesthetics
### Geoms
### Facet
### Labels

```r
g + labs()
```
]

---

.right-column[

```r
g &lt;- g + 
  labs(
    x = "Film Appearances",
    y = "Count of Characters",
    title = "Recurring Star Wars Characters",
    subtitle = "How often do characters appear?",
    fill = "Gender"
  )
```
]

---

.right-column[
&lt;img src="index_files/figure-html/unnamed-chunk-13-1.png" width="90%" /&gt;
]

---
layout: true
# gg is for Grammar of Graphics

.left-column[
### Data
### Aesthetics
### Geoms
### Facet
### Labels
### Scales

```r
g + scale_*_*()
```
]
---

.right-column[ 
`scale` + `_` + `&lt;aes&gt;` + `_` + `&lt;type&gt;` + `()`

What parameter do you want to adjust? → `&lt;aes&gt;` &lt;br&gt;
What type is the parameter? → `&lt;type&gt;`

- I want to change my discrete x-axis&lt;br&gt;`scale_x_discrete()`
- I want to change point size from continuous variable&lt;br&gt;`scale_size_continuous()`
- I want to rescale y-axis as log&lt;br&gt;`scale_y_log10()`
- I want to use a different color palette&lt;br&gt;`scale_fill_discrete()`&lt;br&gt;`scale_color_manual()`
]

---

.right-column[

```r
g &lt;- g + scale_fill_brewer(palette = 'Set1')
```

&lt;img src="index_files/figure-html/unnamed-chunk-15-1.png" width="90%" /&gt;


]

---
layout: true
# gg is for Grammar of Graphics

.left-column[
### Data
### Aesthetics
### Geoms
### Facet
### Labels
### Scales
### Theme

```r
g + theme()
```
]

---

.right-column[
Change the appearance of plot decorations&lt;br&gt;
i.e. things that aren't mapped to data

A few "starter" themes ship with the package

- `g + theme_bw()`
- `g + theme_dark()`
- `g + theme_gray()`
- `g + theme_light()`
- `g + theme_minimal()`

]

---

.right-column[
Huge number of parameters, grouped by plot area:

- Global options: `line`, `rect`, `text`, `title`
- `axis`: x-, y- or other axis title, ticks, lines
- `legend`: Plot legends
- `panel`: Actual plot area
- `plot`: Whole image
- `strip`: Facet labels
]
---

.right-column[
Theme options are supported by helper functions:

- `element_blank()` removes the element
- `element_line()`
- `element_rect()`
- `element_text()`
]

---

.right-column[

```r
g + theme_bw()
```

&lt;img src="index_files/figure-html/unnamed-chunk-16-1.png" width="90%" /&gt;
]

---

.right-column[
.font80[

```r
g + theme_minimal() + theme(text = element_text(family = "Palatino"))
```

&lt;img src="index_files/figure-html/unnamed-chunk-17-1.png" width="90%" /&gt;
]
]

---

.right-column[
You can also set the theme globally with `theme_set()`


```r
my_theme &lt;- theme_bw() +
  theme(
    text = element_text(family = "Palatino", size = 12),
    panel.border = element_rect(colour = 'grey80'), 
    panel.grid.minor = element_blank()
  )

theme_set(my_theme)
```
]

---

.right-column[

```r
g
```

&lt;img src="index_files/figure-html/unnamed-chunk-18-1.png" width="90%" /&gt;
]

---

.right-column[

```r
g + theme(legend.position = 'bottom')
```

&lt;img src="index_files/figure-html/unnamed-chunk-19-1.png" width="90%" /&gt;
]

---
layout: false
count: hide
class: fullscreen, inverse, top, left, text-white
background-image: url(images/super-grover.jpg)

.font200[You have the power!]
---

class: inverse, center, middle

# "Live" Coding


```r
data(tips, package = "reshape2")
```

---
# head(tips)

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; total_bill &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; tip &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; sex &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; smoker &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; day &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; time &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; size &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 16.99 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.01 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Female &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Sun &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Dinner &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 10.34 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.66 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Male &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Sun &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Dinner &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 21.01 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.50 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Male &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Sun &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Dinner &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 23.68 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.31 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Male &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Sun &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Dinner &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 24.59 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.61 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Female &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Sun &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Dinner &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 25.29 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.71 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Male &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Sun &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Dinner &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 8.77 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.00 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Male &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Sun &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Dinner &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 26.88 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.12 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Male &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Sun &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Dinner &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 15.04 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.96 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Male &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Sun &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Dinner &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 14.78 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 3.23 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Male &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; No &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Sun &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Dinner &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# tips: tip histogram


.left-code[

```r
ggplot(tips) +
  aes(x = tip) +
* geom_histogram(
*   binwidth = 0.25
* )
```
]

.right-plot[
&lt;img src="index_files/figure-html/tips-plot1-out-1.png" width="100%" /&gt;
]

---
layout: true
# tips: tip density
---

.left-code[

```r
ggplot(tips) +
  aes(x = tip) +
* geom_density(
*   aes(fill = day)
* )
```
]

.right-plot[
&lt;img src="index_files/figure-html/tips-plot-density1-out-1.png" width="100%" /&gt;
]

---


.left-code[

```r
ggplot(tips) +
  aes(x = tip) +
  geom_density(
    aes(fill = day),
*   alpha = 0.4
  )
```
]

.right-plot[
&lt;img src="index_files/figure-html/tips-plot-density2-out-1.png" width="100%" /&gt;
]

---

.left-code[

```r
ggplot(tips) +
  aes(x = tip/total_bill) +
  geom_density(
    aes(fill = day)
  ) +
* facet_wrap(~ day)
```
]

.right-plot[
&lt;img src="index_files/figure-html/tips-plot-density3-out-1.png" width="100%" /&gt;
]

---
layout: true
# tips: tip vs total
---

.left-code[

```r
ggplot(tips) +
  aes(x = total_bill,
*     y = tip) +
* geom_point()
```
]

.right-plot[
&lt;img src="index_files/figure-html/tips-plot-total1-out-1.png" width="100%" /&gt;
]

---


.left-code[

```r
ggplot(tips) +
  aes(x = total_bill,
      y = tip) +
  geom_point() +
* geom_smooth(method = "lm")
```
]

.right-plot[
&lt;img src="index_files/figure-html/tips-plot-total2-out-1.png" width="100%" /&gt;
]

---

.left-code[

```r
ggplot(tips) +
  aes(x = total_bill,
      y = tip) +
  geom_point() +
  geom_smooth(method = "lm")+ 
* geom_abline(
*   slope = c(0.2, 0.15),
*   intercept = 0,
    color = c('#69b578', 
              "#dd1144"),
    linetype = 3)
```
]

.right-plot[
&lt;img src="index_files/figure-html/tips-plot-total3-out-1.png" width="100%" /&gt;
]

---

.left-code[

```r
ggplot(tips) +
  aes(x = total_bill,
*     y = tip/total_bill) +
  geom_point() +
* geom_hline(
    yintercept = c(0.2, 0.15),
    color = c('#69b578', 
              "#dd1144"),
    linetype = 1)
```
]

.right-plot[
&lt;img src="index_files/figure-html/tips-plot-total4-out-1.png" width="100%" /&gt;
]


---

.left-code[

```r
*tips$percent &lt;-
* tips$tip/tips$total_bill

ggplot(tips) +
  aes(x = size,
*     y = percent,
*     color = smoker) +
  geom_point()
```
]

.right-plot[
&lt;img src="index_files/figure-html/tips-plot-total5-out-1.png" width="100%" /&gt;
]

---

.left-code[

```r
tips$percent &lt;- 
  tips$tip/tips$total_bill

ggplot(tips) +
  aes(x = size,
      y = percent,
      color = smoker) +
* geom_jitter(width = 0.25)
```
]

.right-plot[
&lt;img src="index_files/figure-html/tips-plot-total5b-out-1.png" width="100%" /&gt;
]

---


.left-code[

```r
ggplot(tips) +
  aes(x = day,
      y = percent,
      color = sex) +
  geom_jitter(width = 0.25) +
* facet_grid(time ~ smoker)
```
]

.right-plot[
&lt;img src="index_files/figure-html/tips-plot-total6-out-1.png" width="100%" /&gt;
]

---

.left-code[

```r
tips &lt;- mutate(tips,
* time = factor(time,
*   c("Lunch", "Dinner")),
* day = factor(day,
*   c("Thur", "Fri",
*     "Sat", "Sun")
  ))

ggplot(tips) +
  aes(x = day,
      y = percent,
      color = sex) +
  geom_jitter(width = 0.25) +
  facet_grid(time ~ smoker)
```
]

.right-plot[
&lt;img src="index_files/figure-html/tips-plot-total62-out-1.png" width="100%" /&gt;
]

---

.left-code[

```r
ggplot(tips) +
  aes(x = day,
      y = percent,
      fill = time) +
* geom_boxplot() +
  facet_grid(. ~ smoker)
```
]

.right-plot[
&lt;img src="index_files/figure-html/tips-plot-total7-out-1.png" width="100%" /&gt;
]
---

.left-code[

```r
ggplot(tips) +
  aes(x = day,
      y = percent,
*     color = smoker,
*     fill  = smoker) +
* geom_violin(alpha = 0.3) +
  facet_wrap(~ smoker)
```
]

.right-plot[
&lt;img src="index_files/figure-html/tips-plot-total8-out-1.png" width="100%" /&gt;
]
---

.left-code[

```r
g &lt;- ggplot(tips) +
  aes(x = day,
      y = percent,
      color = smoker,
      fill = smoker) +
  geom_violin(alpha = 0.3) + 
* geom_jitter(alpha = 0.4,
*             width = 0.25,
*             size  = 0.8)+
  facet_wrap(~ smoker)
g
```
]

.right-plot[
&lt;img src="index_files/figure-html/tips-plot-total9-out-1.png" width="100%" /&gt;
]

---

.left-code[

```r
g + guides(color = FALSE,
           fill  = FALSE) +
  labs(x = '', 
       y = 'Tip Rate') +
* scale_y_continuous(
*   labels = scales::percent
* )
```
]

.right-plot[
&lt;img src="index_files/figure-html/tips-plot-total10-out-1.png" width="100%" /&gt;
]

---
layout: false
class: inverse, center, middle

# Level up


```r
data(babynames, 'babynames')
```

---
# head(babynames)

The [babynames package](https://github.com/hadley/babynames) contains data provided by the USA social security administration:

* `babynames`: For each year from 1880 to 2015, the number of children of &lt;br&gt;
  each sex given each name. All names with more than 5 uses are given.

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; sex &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; name &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; n &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; prop &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2008 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; F &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Shakyla &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1939 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; F &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Leverne &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2013 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; M &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Can &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2013 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; M &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Juston &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2002 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; M &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Reis &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 36 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1944 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; F &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Loy &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
layout: true
# Most popular baby names in 2015
---

.pull-left[

```r
babynames_pop2015 &lt;- babynames %&gt;% 
  filter(year == 2015) %&gt;% 
  mutate(
    n = n/1000,
    sex = case_when(
      sex == "F" ~ "Girl Names",
      TRUE ~ "Boy Names"
  )) %&gt;% 
  group_by(sex) %&gt;% 
  top_n(10, n)
```
]

.pull-right[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; sex &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; name &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; n &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; prop &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2015 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Boy Names &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Noah &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 19.511 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.010 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2015 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Boy Names &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Liam &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 18.281 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.009 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2015 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Boy Names &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Mason &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16.535 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.008 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2015 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Boy Names &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Jacob &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15.816 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.008 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2015 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Girl Names &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Emma &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 20.355 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.011 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2015 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Girl Names &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Olivia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 19.553 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.010 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2015 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Girl Names &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Sophia &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 17.327 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.009 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 2015 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Girl Names &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Ava &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 16.286 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.008 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

---


```r
g_babynames &lt;- ggplot(babynames_pop2015) +
* aes(y = n, x = name) +
* geom_col()
```

.plot-callout[
&lt;img src="index_files/figure-html/unnamed-chunk-25-1.png" width="100%" height="99%" /&gt;
]

---


```r
g_babynames &lt;- ggplot(babynames_pop2015) +
  aes(y = n, x = name) +
  geom_col() +
* coord_flip()
```

.plot-callout[
&lt;img src="index_files/figure-html/unnamed-chunk-26-1.png" width="100%" height="99%" /&gt;
]

---


```r
g_babynames &lt;- ggplot(babynames_pop2015) +
* aes(y = n, x = fct_reorder(name, n)) +
  geom_col() +
  coord_flip()
```

&lt;br&gt;📦 `fct_reorder` comes from the tidyverse package `forecats`

.plot-callout[
&lt;img src="index_files/figure-html/unnamed-chunk-27-1.png" width="100%" height="99%" /&gt;
]

---


```r
g_babynames &lt;- ggplot(babynames_pop2015) +
* aes(y = n, x = fct_reorder(name, n), fill = sex) +
  geom_col() +
  coord_flip()
```

.plot-callout[
&lt;img src="index_files/figure-html/unnamed-chunk-28-1.png" width="100%" height="99%" /&gt;
]

---


```r
g_babynames &lt;- ggplot(babynames_pop2015) +
  aes(y = n, x = fct_reorder(name, n), fill = sex) +
  geom_col() +
  coord_flip() +
* facet_wrap( ~ sex, scales = 'free_y')
```

.plot-callout[
&lt;img src="index_files/figure-html/unnamed-chunk-29-1.png" width="100%" height="99%" /&gt;
]

---

```r
g_babynames &lt;- ggplot(babynames_pop2015) +
  aes(y = n, x = fct_reorder(name, n), fill = sex) +
  geom_col() +
* geom_text(
*   aes(label = format(n*1000, big.mark = ',')),
*   size = 9, hjust = 1.1, 
*   color = 'white', family = 'Fira Sans'
* ) +
  coord_flip() +
  facet_wrap( ~ sex, scales = 'free_y')
```

.plot-callout[
&lt;img src="index_files/figure-html/unnamed-chunk-30-1.png" width="100%" height="99%" /&gt;
]

---


```r
g_babynames +
  labs(x = '', 
       y = 'Number of Babies Born in 2015 (thousands)') + 
  guides(fill = FALSE) +
  scale_fill_manual(
    values = c("Boy Names"  = "#77cbb9",
               "Girl Names" = "#a077cb")) +
  theme(
    strip.text = element_text(face = 'bold', size = 20),
    strip.background = element_blank(),
    text = element_text(size = 24)
  )
```

.plot-callout[
&lt;img src="index_files/figure-html/babynames-popular-out-callout-1.png" width="100%" height="99%" /&gt;
]

---

&lt;img src="index_files/figure-html/babynames-popular-out-1.png" width="100%" /&gt;

---
layout: true
# Gender-bending baby names
---

Find babynames that were

1. More "boyish" or "girlish" in pre-1900s and opposite in post-1900s

2. Pick top 10 boy ↔ girl names
--



**Boy → Girl Names:**&lt;br&gt; Madison, Ashley, Alexis, Lauren, Taylor, Addison, Sydney, Allison, Morgan, Aubrey

**Girl → Boy Names:**&lt;br&gt; Ollie, Jean, Lou, Cruz, Frankie, Alpha, Artie, Vinnie, Donnie, Lue

---

.pull-left[
Data-preprocessing:

1. Un-tidy `sex` column into `Female` and `Male`

2. Calculate difference in proportion by name

3. Add groups for area plot (thank you [stackoverflow](https://stackoverflow.com/a/7883556)!)

&lt;br&gt;&lt;br&gt;Check out `babynames-prep.R` in repo
]

.pull-right[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:right;"&gt; year &lt;/th&gt;
   &lt;th style="text-align:left;"&gt; name &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; prop &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; prop_group &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1886 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Jean &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.00071 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1891 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Jean &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.00077 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1908 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Vinnie &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.00009 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1916 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Taylor &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.00011 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1917 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Artie &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.00008 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1921 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Lou &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.00023 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1940 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Vinnie &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.00003 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1944 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Morgan &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; -0.00009 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1975 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Alexis &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.00030 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:right;"&gt; 1993 &lt;/td&gt;
   &lt;td style="text-align:left;"&gt; Lauren &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 0.00820 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

---


```r
ggplot(sel_change_babynames) + 
  aes(x = year, y = prop)
```

.plot-callout[
&lt;img src="index_files/figure-html/genben-plot1-out-1.png" width="100%" height="99%" /&gt;
]

---


```r
ggplot(sel_change_babynames) + 
  aes(x = year, y = prop) +
* geom_line(color = "grey50", aes(group=name))
```

.plot-callout[
&lt;img src="index_files/figure-html/genben-plot2-out-1.png" width="100%" height="99%" /&gt;
]

---


```r
ggplot(sel_change_babynames) + 
  aes(x = year, y = prop, fill = prop &gt; 0) +
* geom_area(aes(group = prop_group)) +
  geom_line(color = "grey50", aes(group=name))+
* facet_wrap(~ name, scales = 'free_y', ncol = 5)
```

.plot-callout[
&lt;img src="index_files/figure-html/genben-plot3-out-1.png" width="100%" height="99%" /&gt;
]

---


```r
g_bnc &lt;- ggplot(sel_change_babynames) + 
  aes(x = year, y = prop, fill = prop &gt; 0) +
  geom_area(aes(group = prop_group)) +
  geom_line(color = "grey50", aes(group=name))+
  facet_wrap(~ name, scales = 'free_y', ncol = 5) + 
* scale_fill_manual(values = c("#6ec4db", "#fa7c92")) +
* guides(fill = FALSE) +
* labs(x = '', y = '')

g_bnc
```

.plot-callout[
&lt;img src="index_files/figure-html/genben-plot4-out-1.png" width="100%" height="99%" /&gt;
]


---


```r
g_bnc &lt;- g_bnc +
  theme_minimal(base_family = 'Palatino') +
  theme(
    axis.text.y = element_blank(),
    strip.text = element_text(size = 18, face = 'bold'),
    panel.grid.major.y = element_blank(),
    panel.grid.minor.y = element_blank(),
    panel.grid.minor.x = element_blank(),
    panel.grid.major.x = element_line(color = "grey80", linetype = 3))
```

.plot-callout[
&lt;img src="index_files/figure-html/genben-plot5-out-1.png" width="100%" height="99%" /&gt;
]

---

&lt;img src="index_files/figure-html/genben-plot-out-1.png" width="100%" height="99%" /&gt;

---
layout: false
class: inverse, middle, center

# g is for Goodbye
---
layout: true
# Stack Exchange is Awesome
---

![](images/stack-exchange-search.png)
---
![](images/stack-exchange-answer.png)

---
layout: false

# ggplot2 Extensions: ggplot2-exts.org

![](images/ggplot2-exts-gallery.png)

---
# ggplot2 and beyond

### Learn more

- **ggplot2 docs:** &lt;http://ggplot2.tidyverse.org/&gt;

- **R4DS - Data visualization:** &lt;http://r4ds.had.co.nz/data-visualisation.html&gt;

- **Hadley Wickham's ggplot2 book:** &lt;https://www.amazon.com/dp/0387981403/&gt;

### Noteworthy RStudio Add-Ins

- [ggplotThemeAssist](https://github.com/calligross/ggthemeassist): Customize your ggplot theme interactively

- [ggedit](https://github.com/metrumresearchgroup/ggedit): Layer, scale, and theme editing

---

# Practice and Review

### Fun Datasets

- `fivethirtyeight`

- `nycflights`

- `ggplot2movies`

- `population` and `who` in `tidyr`

### Review

- Slides and code on GitHub: &lt;http://github.com/gadenbuie/trug-ggplot2&gt;

---
class: inverse, center, middle

# Thanks!

.font150.text-white[
@grrrck &lt;br&gt;
github.com/gadenbuie &lt;br&gt;
Garrick Aden-Buie
]
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"slideNumberFormat": "%current%"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script>
(function() {
  var i, text, code, codes = document.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
})();
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
